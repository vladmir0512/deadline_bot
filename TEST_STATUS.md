# Статус проверки тестов и скриптов

Формат: один файл — одна строка.

Колонки:
- **Файл**: относительный путь от корня
- **Тип**: test / check / util / other
- **Статус проверки**: not_started / ok / error / needs_data / deprecated / removed
- **Комментарий**: кратко, что показал запуск

## Уже проверенные

- **Файл**: `tests/integration/test_notifications.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Запускается, логика дат поправлена, уведомлений нет из-за отсутствия подходящих дедлайнов.

- **Файл**: `scripts/check_db.py`
  - **Тип**: check
  - **Статус проверки**: needs_data
  - **Комментарий**: Скрипт рабочий, но БД по умолчанию (`data/моя_база.db`) отсутствует.

- **Файл**: `scripts/check_real_data.py`
  - **Тип**: check
  - **Статус проверки**: ok
  - **Комментарий**: Успешно выводит реальных пользователей и дедлайны, показывает анализ половины срока.

- **Файл**: `tests/integration/test_sync_logic.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Успешно грузит CSV из Yonote, находит дедлайны для `vj_games`, сравнивает с БД, предлагает 3 тайтла к созданию.

- **Файл**: `tests/integration/test_sync.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Успешно синхронизирует дедлайны для `VJ_Games`, CSV загружается, в БД обновлено 3 дедлайна.

- **Файл**: `tests/integration/test_sync_with_csv.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Успешно синхронизирует дедлайны пользователя с CSV, после синка у пользователя 2 дедлайна в БД.

- **Файл**: `tests/integration/test_halfway_notification.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Логика половины срока и should_send_notification отрабатывает, вывод адаптирован под cp1251-консоль, финальная сводка проходит без ошибок.

- **Файл**: `tests/integration/test_current_halfway.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Проверяет текущие реальные дедлайны на половине срока, корректно находит 1 подходящий и сверяется с get_deadlines_at_halfway.

- **Файл**: `tests/integration/test_sync_manual.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Ручной запуск синхронизации с CSV для пользователя `VJ_Games`, выводит статистику (создано 0, обновлено 3).

- **Файл**: `tests/manual/test_regular_dash.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Проверка форматирования вывода регулярных дедлайнов и разделителей, выполняется без ошибок.

- **Файл**: `tests/integration/test_delete_logic.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Создаёт лишний дедлайн и проверяет, что после синка остаются только актуальные, но один тестовый Yonote-дедлайн остаётся как контрольный.

- **Файл**: `tests/integration/test_deletion_scenario.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Создаёт несколько лишних дедлайнов и проверяет, что основная логика отображения использует только корректные записи, даже если в БД остались лишние Yonote-дедлайны.

- **Файл**: `tests/integration/test_new_csv.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Тестирует новый CSV-клиент по имени пользователя, корректно находит дедлайны ArAhis и без фильтра.

- **Файл**: `tests/integration/test_csv_api.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Исправлен BOM и вывод в cp1251, DictReader читает через ';', показывает заголовки, первые строки, поля людей и дат.

- **Файл**: `tests/integration/test_arahis.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Проверяет fetch_user_deadlines для ArAhis в разных регистрах и без фильтра, данные приходят корректно.

- **Файл**: `tests/integration/test_fetch.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Проверяет fetch_user_deadlines по email и username, а также общий список, фильтры работают ожидаемо.

- **Файл**: `tests/integration/test_sync_fix.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Дополнительный интеграционный тест синка для `VJ_Games`, сверяет количество дедлайнов до и после.

- **Файл**: `tests/integration/test_sync_after_register.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Проверяет синхронизацию после регистрации пользователя, в итоге у пользователя 2 дедлайна.

- **Файл**: `tests/integration/test_changes.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Тестирует выборку дедлайнов с параметром include_no_date, выводит списки с/без дедлайнов без даты.

- **Файл**: `tests/manual/test_simple_line.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Проверка короткой ASCII-линии-разделителя в выводе, больше не использует Unicode-символы.

- **Файл**: `tests/manual/test_short_line.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Визуальный тест короткой линии и русского текста, эмодзи заменены на ASCII, работает в cp1251-консоли.

- **Файл**: `tests/manual/test_short_line2.py`
  - **Тип**: test
  - **Статус проверки**: ok
  - **Комментарий**: Аналогичный ASCII-вариант короткой линии и вывода дедлайнов, без эмодзи.

- **Файл**: `scripts/verify_all.py`
  - **Тип**: util
  - **Статус проверки**: ok
  - **Комментарий**: Комплексный smoke-test всех компонентов, полностью проходит, вывод только ASCII ([OK]/[WARN]/[ERROR]).

- **Файл**: `scripts/check_all_deadlines.py`
  - **Тип**: check
  - **Статус проверки**: ok
  - **Комментарий**: Показывает дедлайны пользователя и сводку по всем пользователям и источникам в БД.

- **Файл**: `scripts/check_all_sources.py`
  - **Тип**: check
  - **Статус проверки**: ok
  - **Комментарий**: Сводка дедлайнов по источникам (yonote/test_manual) и результат синка, без ошибок.

- **Файл**: `scripts/check_full_deadline_status.py`
  - **Тип**: check
  - **Статус проверки**: ok
  - **Комментарий**: Детальная проверка статусов дедлайнов пользователя и того, что покажет команда my_deadlines.

- **Файл**: `scripts/check_db_state.py`
  - **Тип**: check
  - **Статус проверки**: ok
  - **Комментарий**: Краткая сводка по пользовательским дедлайнам в БД.

- **Файл**: `scripts/check_arahis_deadlines.py`
  - **Тип**: check
  - **Статус проверки**: ok
  - **Комментарий**: Показывает дедлайны VJ_Games и ArAhis для визуальной проверки.

- **Файл**: `scripts/check_correct_user.py`
  - **Тип**: check
  - **Статус проверки**: ok
  - **Комментарий**: Проверяет, что основной пользователь и его дедлайны выбраны корректно.

- **Файл**: `scripts/check_sync.py`
  - **Тип**: check
  - **Статус проверки**: ok
  - **Комментарий**: Ещё один ручной запуск синка и сводка по дедлайнам пользователя после него.

- **Файл**: `scripts/init_db.py`
  - **Тип**: util
  - **Статус проверки**: ok
  - **Комментарий**: Инициализирует БД, при повторном запуске сообщает, что всё уже создано.

- **Файл**: `scripts/migrate_add_last_notified.py`
  - **Тип**: util
  - **Статус проверки**: removed
  - **Комментарий**: Удалено как legacy-миграция под старую БД `../data/моя_база.db`.

- **Файл**: `scripts/migrate_add_source_id.py`
  - **Тип**: util
  - **Статус проверки**: removed
  - **Комментарий**: Удалено как legacy-миграция под старую БД `../data/моя_база.db`.

- **Файл**: `scripts/sync_arahis.py`
  - **Тип**: util
  - **Статус проверки**: ok
  - **Комментарий**: Синхронизация для пользователя VJ_Games, показывает статистику создания/обновления дедлайнов.

- **Файл**: `scripts/sync_deadlines.py`
  - **Тип**: util
  - **Статус проверки**: ok
  - **Комментарий**: Прогоняет синк для основного пользователя, после выполнения в БД ожидаемые дедлайны.

- **Файл**: `scripts/send_test_notification.py`
  - **Тип**: util
  - **Статус проверки**: ok
  - **Комментарий**: Отправляет тестовое уведомление реальному пользователю (использовать осторожно).

- **Файл**: `scripts/create_test_halfway_deadline.py`
  - **Тип**: util
  - **Статус проверки**: ok
  - **Комментарий**: Создаёт тестовый дедлайн «на половине срока» для проверки уведомлений, выводит его параметры.

- **Файл**: `scripts/yonote_client.py`
  - **Тип**: util
  - **Статус проверки**: ok
  - **Комментарий**: Импортируется и используется другими скриптами, при прямом запуске выполняет отладочные вызовы (проверено через debug-скрипты).

- **Файл**: `scripts/yonote_csv_client.py`
  - **Тип**: util
  - **Статус проверки**: ok
  - **Комментарий**: CSV-клиент Yonote, корректно работает в интеграционных тестах и debug-скриптах.

- **Файл**: `scripts/debug_structure.py`
  - **Тип**: util
  - **Статус проверки**: ok
  - **Комментарий**: Отладка структуры дедлайнов и классов, выводит текущее состояние без ошибок.

- **Файл**: `scripts/debug_db.py`
  - **Тип**: util
  - **Статус проверки**: error
  - **Комментарий**: Запускается с ASCII-выводом, но падает если БД по пути по умолчанию не существует (нет таблицы users). Использовать с актуальным DATABASE_URL.

- **Файл**: `scripts/debug_yonote.py`
  - **Тип**: util
  - **Статус проверки**: ok
  - **Комментарий**: Показывает сырые и распарсенные данные из Yonote, отрабатывает без Unicode-ошибок.

- **Файл**: `scripts/change_back_to_arahis.py`
  - **Тип**: util
  - **Статус проверки**: ok
  - **Комментарий**: Переключает основного пользователя на ArAhis (изменяет username), выводит итоговое состояние.

- **Файл**: `scripts/enhanced_debug.py`
  - **Тип**: util
  - **Статус проверки**: error
  - **Комментарий**: Работает с текущим CSV-клиентом (raw_data=list из моделей), выводит ключи/первые элементы; не видит values, т.к. структура поменялась. Нужен рефактор под актуальные модели данных.

## Не проверенные

(Остались: сам `bot.py`, `services.py`, `notifications.py`, `models.py`, `db.py` — они часть основного приложения и проверяются через интеграционные тесты и `scripts/verify_all.py`.)
